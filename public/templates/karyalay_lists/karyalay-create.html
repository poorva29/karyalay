<div ng-controller="karyalayCreateCtrl">
  <div id="layoutKaryalay">
    <div flash-message="5000" ></div>
  </div>
  <div id="karyalayCreate" class="container-fluid">
    <!-- <button type="button" class="btn btn-default btn-sm" ng-click="foo()">Logout</button> -->
    <script type="text/ng-template" id="addPandit.html">
      <div class="" id="karyalayPandit">
        <div class="form-group">
          <label class="control-label col-sm-2" for="first_name">First Name:</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" id="first_name" ng-model="subitem.first_name" placeholder="First Name">
          </div>
          <div class="col-sm-1">
            <button type="button" class="btn btn-default btn-danger" aria-label="Left Align" ng-click="removePandit($index)">
              <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
            </button>
          </div>
        </div>
        <div class="form-group">
          <label class="control-label col-sm-2" for="last_name">Last Name:</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" id="last_name" ng-model="subitem.last_name" placeholder="Surname Name">
          </div>
        </div>
        <div class="form-group">
          <label class="control-label col-sm-2" for="last_name">Ph. Number:</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" id="phone_number" ng-model="subitem.phone_number" placeholder="Phone Number">
          </div>
        </div>
        <div class="form-group">
          <label class="control-label col-sm-2" for="last_name">Email:</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" id="email" ng-model="subitem.email" placeholder="pandit@karyalay.com">
          </div>
        </div>
        <hr class="template-seperator">
      </div>
    </script>
    <script type="text/ng-template" id="addCaterer.html">
      <div class="" id="karyalayCaterer">
        <div class="form-group">
          <label class="control-label col-sm-2" for="first_name">First Name:</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" id="first_name" ng-model="subitem.first_name" placeholder="First Name">
          </div>
          <div class="col-sm-1">
            <button type="button" class="btn btn-default btn-danger" aria-label="Left Align" ng-click="removeCaterer($index)">
              <span class="glyphicon glyphicon-minus" aria-hidden="true"></span>
            </button>
          </div>
        </div>
        <div class="form-group">
          <label class="control-label col-sm-2" for="last_name">Last Name:</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" id="last_name" ng-model="subitem.last_name" placeholder="Surname Name">
          </div>
        </div>
        <div class="form-group">
          <label class="control-label col-sm-2" for="last_name">Ph. Number:</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" id="phone_number" ng-model="subitem.phone_number" placeholder="Phone Number">
          </div>
        </div>
        <div class="form-group">
          <label class="control-label col-sm-2" for="last_name">Email:</label>
          <div class="col-sm-6">
            <input type="text" class="form-control" id="email" ng-model="subitem.email" placeholder="caterer@karyalay.com">
          </div>
        </div>
        <div class="form-group">
          <label class="control-label col-sm-2" for="last_name">Speciality:</label>
          <div class="col-sm-6 pandit-email">
            <ui-select multiple ng-model="subitem.specialites" ng-disabled="disabled">
              <ui-select-match placeholder="Select specials...">{{$item}}</ui-select-match>
              <ui-select-choices repeat="specials in availableSpecialites | filter:$select.search">
                {{specials}}
              </ui-select-choices>
            </ui-select>
          </div>
        </div>
        <hr class="template-seperator">
      </div>
    </script>
    <div class="row">
      <accordion close-others="oneAtATime">
        <accordion-group is-open="status.openKaryalay">
          <accordion-heading>
            Create Karyalay <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.openKaryalay, 'glyphicon-chevron-right': !status.openKaryalay}"></i>
          </accordion-heading>
          <fieldset id="karyalayCreateForm" class="col-md-11 col-md-offset-2" ng-disabled="saveStatus.saveKaryalay">
            <form name="karyalayCreateFormValidate" class="form-horizontal" role="form">
              <div class="form-group">
                <label class="control-label col-sm-2" for="email">Name: <label class="validation-color">*</label></label>
                <div class="col-sm-6">
                  <input type="text" class="form-control" id="email" ng-model="karyalayCreateForm.name" placeholder="Enter Name" name="name" required>
                  <span class="validation-color" ng-show="karyalayCreateFormValidate.name.$dirty && karyalayCreateFormValidate.name.$invalid">
                    <span ng-show="karyalayCreateFormValidate.name.$error.required">Karyalay name is required.</span>
                  </span>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-2" for="pwd">Address: <label class="validation-color">*</label></label>
                <div class="col-sm-6">
                  <textarea class="form-control" id="pwd" ng-model="karyalayCreateForm.address" placeholder="Enter Address" name="address" required></textarea>
                  <span class="validation-color" ng-show="karyalayCreateFormValidate.address.$dirty && karyalayCreateFormValidate.address.$invalid">
                    <span ng-show="karyalayCreateFormValidate.address.$error.required">Karyalay address is required.</span>
                  </span>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-2" for="pwd">State: <label class="validation-color">*</label></label>
                <div class="col-sm-3">
                  <input type="text" class="form-control" id="pwd" ng-model="karyalayCreateForm.state" placeholder="Goa" required>
                  <span class="validation-color" ng-show="karyalayCreateFormValidate.state.$dirty && karyalayCreateFormValidate.state.$invalid">
                    <span ng-show="karyalayCreateFormValidate.state.$error.required">State is required.</span>
                  </span>
                </div>
                <label class="control-label col-sm-1" for="pwd">City: <label class="validation-color">*</label></label>
                <div class="col-sm-2">
                  <input type="text" class="form-control" id="pwd" ng-model="karyalayCreateForm.city" placeholder="Panaji" required>
                  <span class="validation-color" ng-show="karyalayCreateFormValidate.city.$dirty && karyalayCreateFormValidate.city.$invalid">
                    <span ng-show="karyalayCreateFormValidate.city.$error.required">City is required.</span>
                  </span>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-2" for="pwd">Location: <label class="validation-color">*</label></label>
                <div class="col-sm-3">
                  <input type="text" class="form-control" id="pwd" ng-model="karyalayCreateForm.location" placeholder="Area" required>
                  <span class="validation-color" ng-show="karyalayCreateFormValidate.location.$dirty && karyalayCreateFormValidate.location.$invalid">
                    <span ng-show="karyalayCreateFormValidate.location.$error.required">Area is required.</span>
                  </span>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-2" for="pwd">Lankmark:</label>
                <div class="col-sm-6">
                  <input type="text" class="form-control" id="pwd" ng-model="karyalayCreateForm.landmark" placeholder="Enter Landmark">
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-2" for="pwd">Description:</label>
                <div class="col-sm-6">
                  <input type="text" class="form-control" id="pwd" ng-model="karyalayCreateForm.description" placeholder="Enter Description">
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-2" for="pwd">Ph. Number: <label class="validation-color">*</label></label>
                <div class="col-sm-6">
                  <input type="number" class="form-control" id="pwd" ng-model="karyalayCreateForm.phone_number" placeholder="Enter Number" name="number" required>
                  <span class="validation-color" ng-show="karyalayCreateFormValidate.number.$dirty">
                    <span ng-show="karyalayCreateFormValidate.number.$error.required">Karyalay number is required.</span>
                    <span ng-show="karyalayCreateFormValidate.number.$error.number"> Please enter a valid number </span>
                  </span>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-2" for="pwd">Email: <label class="validation-color">*</label></label>
                <div class="col-sm-6">
                  <input type="email" name="email" class="form-control" id="pwd" ng-model="karyalayCreateForm.email" placeholder="Enter Karyalay Email" required>
                  <span class="validation-color" ng-show="karyalayCreateFormValidate.email.$dirty && karyalayCreateFormValidate.email.$invalid">
                    <span ng-show="karyalayCreateFormValidate.email.$error.required">Email is required.</span>
                    <span ng-show="karyalayCreateFormValidate.email.$error.email">Invalid email address.</span>
                  </span>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-offset-2 col-sm-6">
                  <button type="submit" class="btn btn-default" ng-disabled="karyalayCreateFormValidate.$invalid" ng-click="createKaryalay()">Save</button>
                </div>
              </div>
            </form>
          </fieldset>
        </accordion-group>
        <accordion-group is-open="status.openKaryalayGallery" ng-show="saveStatus.saveKaryalay">
          <accordion-heading>
            Karyalay Photo Gallery <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.openKaryalayGallery, 'glyphicon-chevron-right': !status.openKaryalayGallery}"></i>
          </accordion-heading>
          <fieldset id="karyalayGalleryCreateForm" class="col-md-11 col-md-offset-2">
            <form name="karyalayCreateGalleryFormValidity" class="form-horizontal" role="form">
              <div class="form-group">
                <label class="control-label col-sm-3" for="pwd">Upload Images:</label>
                <div class="col-sm-3">
                  <input type="file" ngf-select multiple ng-model="karyalayGalleryCreateForm.picFile" name="file" accept="image/*" ngf-max-size="2MB">
                  <!-- <i ng-show="karyalayUpdateGalleryFormValidity.file.$error.required">*required</i><br> -->
                  <i ng-show="karyalayUpdateGalleryFormValidity.file.$error.maxSize">File too large {{picFile.size / 1000000|number:1}}MB: max 2M</i>
                  <img ng-show="karyalayUpdateGalleryFormValidity.file.$valid" ngf-thumbnail="karyalayGalleryCreateForm.picFile" class="thumb">
                  <button ng-click="picFile = null" ng-show="picFile">Remove</button>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-offset-3 col-sm-3">
                  <button type="submit" class="btn btn-default" ng-click="saveKaryalayPhotos()">Upload Images</button>
                </div>
              </div>
              <div class="text-center karyalay-label">
                <legend> Uploaded Files </legend>
              </div>
              <div class="form-group">
                <div class="col-sm-9">
                  <div ng-repeat="image in karyalayPhotos" class="col-sm-3">
                    <img ng-src="{{image.url}}" class="img-thumbnail" ng-class="{'increase-width': image.size < 5000 }">
                  </div>
                </div>
              </div>
            </form>
          </fieldset>
        </accordion-group>
        <accordion-group is-open="status.openKaryalayAttr" ng-show="saveStatus.saveKaryalay">
          <accordion-heading>
            Karyalay Attributes <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.openKaryalayAttr, 'glyphicon-chevron-right': !status.openKaryalayAttr}"></i>
          </accordion-heading>
          <fieldset id="karyalayAttrCreateForm" class="col-md-11 col-md-offset-2" ng-disabled="saveStatus.saveKaryalayAttr">
            <form name="karyalayAttrCreateFormValidity" class="form-horizontal" role="form">
              <div class="form-group">
                <label class="control-label col-sm-3" for="email">Accomodate People:</label>
                <div class="col-sm-3">
                  <input type="number" name="number_ppl" class="form-control" id="email" ng-model="karyalayAttrCreateForm.no_of_people" placeholder="People Count">
                  <span class="validation-color" ng-show="karyalayAttrCreateFormValidity.number_ppl.$dirty">
                    <span ng-show="karyalayAttrCreateFormValidity.number_ppl.$error.number"> Please enter a valid number </span>
                  </span>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-3" for="pwd">No. Of Rooms:</label>
                <div class="col-sm-3">
                  <input type="number" name="number_rooms" class="form-control" id="email" ng-model="karyalayAttrCreateForm.no_of_rooms" placeholder="Room Count">
                  <span class="validation-color" ng-show="karyalayAttrCreateFormValidity.number_rooms.$dirty">
                    <span ng-show="karyalayAttrCreateFormValidity.number_rooms.$error.number"> Please enter a valid number </span>
                  </span>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-3" for="pwd">Size In Sq. Feet:</label>
                <div class="col-sm-3">
                  <input type="number" name="number_size" class="form-control" id="pwd" ng-model="karyalayAttrCreateForm.size_in_sq" placeholder="Size Of Hall">
                  <span class="validation-color" ng-show="karyalayAttrCreateFormValidity.number_size.$dirty">
                    <span ng-show="karyalayAttrCreateFormValidity.number_size.$error.number"> Please enter a valid number </span>
                  </span>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-3" for="pwd">Price Half Day:</label>
                <div class="col-sm-3">
                  <input type="number" name="number_half_price" class="form-control" id="pwd" ng-model="karyalayAttrCreateForm.price_half_day" placeholder="">
                  <span class="validation-color" ng-show="karyalayAttrCreateFormValidity.number_half_price.$dirty">
                    <span ng-show="karyalayAttrCreateFormValidity.number_half_price.$error.number"> Please enter a valid number </span>
                  </span>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-3" for="pwd">Price Full Day:</label>
                <div class="col-sm-3">
                  <input type="number" name="number_full_price" class="form-control" id="pwd" ng-model="karyalayAttrCreateForm.price_full_day" placeholder="">
                  <span class="validation-color" ng-show="karyalayAttrCreateFormValidity.number_full_price.$dirty">
                    <span ng-show="karyalayAttrCreateFormValidity.number_full_price.$error.number"> Please enter a valid number </span>
                  </span>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-offset-3 col-sm-3">
                  <button type="submit" class="btn btn-default" ng-disabled="karyalayAttrCreateFormValidity.$invalid" ng-click="createKaryalayAttr()">Save</button>
                </div>
              </div>
            </form>
          </fieldset>
        </accordion-group>
        <accordion-group is-open="status.openKaryalayDependents" ng-show="saveStatus.saveKaryalay">
          <accordion-heading>
            Karyalay Dependency <i class="pull-right glyphicon" ng-class="{'glyphicon-chevron-down': status.openKaryalayDependents, 'glyphicon-chevron-right': !status.openKaryalayDependents}"></i>
          </accordion-heading>
          <fieldset id="karyalayDependentCreateForm" class="col-md-11 col-md-offset-2" ng-disabled="saveStatus.saveKaryalayDependents">
            <form name="karyalayAttrDepCreateFormValidity" class="form-horizontal" role="form">
              <div class="form-group">
                <label class="control-label col-sm-2" for="pwd">Provide Offers:</label>
                <div class="col-sm-1">
                  <checkbox class="btn-info align-checkbox" ng-model="karyalayDependentCreateForm.provide_offers"></checkbox>
                </div>
                <label class="control-label col-sm-3" for="pwd">Provide Samagri:</label>
                <div class="col-sm-1">
                  <checkbox class="btn-info align-checkbox" ng-model="karyalayDependentCreateForm.has_samagri"></checkbox>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-2" for="pwd">Has A/C:</label>
                <div class="col-sm-1">
                  <checkbox class="btn-info align-checkbox" ng-model="karyalayDependentCreateForm.has_ac"></checkbox>
                </div>
                <label class="control-label col-sm-3" for="pwd">Has Pandit:</label>
                <div class="col-sm-1">
                  <checkbox class="btn-info align-checkbox" ng-model="karyalayDependentCreateForm.has_pandit"></checkbox>
                </div>
              </div>
              <div class="form-group">
                <label class="control-label col-sm-2" for="pwd">Has Caterer:</label>
                <div class="col-sm-1">
                  <checkbox class="btn-info align-checkbox" ng-model="karyalayDependentCreateForm.has_caterer"></checkbox>
                </div>
                <label class="control-label col-sm-3" for="pwd">Has Garden:</label>
                <div class="col-sm-1">
                  <checkbox class="btn-info align-checkbox" ng-model="karyalayDependentCreateForm.has_garden"></checkbox>
                </div>
              </div>
            </form>
            <form name="karyalaySaveCreateFormValidity" class="form-horizontal" role="form">
              <div ng-show="karyalayDependentCreateForm.has_samagri">
                <div class="text-center karyalay-label">
                  <legend> Add Samagri </legend>
                </div>
                <div class="form-group">
                  <label class="control-label col-sm-2" for="category">Add Category:</label>
                  <div class="col-sm-6">
                    <ui-select ng-model="category.selected" ng-disabled="disabled" on-select="fetchTags()">
                      <ui-select-match placeholder="Select Category">{{$select.selected.name}}</ui-select-match>
                      <ui-select-choices repeat="category in categoryItems | propsFilter: {name: $select.search, id: $select.search}">
                        <div ng-bind-html="category.name | highlight: $select.search"></div>
                      </ui-select-choices>
                    </ui-select>
                  </div>
                </div>
                <div ng-show="category.hasSelected">
                  <div class="form-group">
                    <label class="control-label col-sm-2" for="tags">Add Items:</label>
                    <div class="col-sm-6">
                      <ui-select multiple ng-model="multipleItmes.selectedItem" ng-disabled="disabled" on-select="selectItem($item, $model)" on-remove="removeItem($item, $model)">
                        <ui-select-match placeholder="Select item...">{{$item.name}} &#40;{{$item.category}}&#41;</ui-select-match>
                        <ui-select-choices repeat="item in items | propsFilter: {name: $select.search, id: $select.search}" refresh="refreshTagNames($select.search)" refresh-delay="0">
                          <div ng-bind-html="item.name | highlight: $select.search"></div>
                        </ui-select-choices>
                      </ui-select>
                    </div>
                  </div>
                </div>
              </div>
              <div ng-show="karyalayDependentCreateForm.has_caterer">
                <div class="text-center karyalay-label">
                  <legend> Create Caterer </legend>
                </div>
                <div class="form-group">
                  <label class="col-sm-2 control-label">Select Caterer:</label>
                  <div class="col-sm-6">
                    <label class="radio-inline"> <input type="radio" ng-model="radioAppointment.selected_caterer_type" ng-init="radioAppointment.selected_caterer_type = 2" ng-value=2 ng-change="changeCatererType()"> New </label>
                    <label class="radio-inline"> <input type="radio" ng-model="radioAppointment.selected_caterer_type" ng-value=1 ng-change="changeCatererType()"> Existing </label>
                  </div>
                </div>
                <div ng-show="showNewCaterer">
                  <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-1">
                      <button type="button" class="btn btn-default btn-success" aria-label="Left Align" ng-click="addCaterer()">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add Caterer
                      </button>
                    </div>
                  </div>
                  <div ng-repeat="subitem in selectCatererDetails.subitems track by $index">
                    <sub-caterer-item-partial></sub-item-partial>
                  </div>
                </div>
                <div ng-hide="showNewCaterer">
                  <div class="form-group">
                    <div class="col-sm-6 col-sm-offset-2">
                      <ui-select multiple ng-model="multipleItmes.selectedCaterer" ng-disabled="disabled">
                        <ui-select-match placeholder="Select caterer...">{{$item.first_name}} {{$item.last_name}}</ui-select-match>
                        <ui-select-choices repeat="catererSel in catererList | propsFilter: {first_name: $select.search, last_name: $select.search}">
                          <div ng-bind-html="catererSel.first_name + ' ' + catererSel.last_name| highlight: $select.search"></div>
                          <small>
                            email: {{catererSel.email}}
                            phone: <span ng-bind-html="''+catererSel.phone_number | highlight: $select.search"></span>
                          </small>
                        </ui-select-choices>
                      </ui-select>
                    </div>
                  </div>
                </div>
              </div>
              <div ng-show="karyalayDependentCreateForm.has_pandit">
                <div class="text-center karyalay-label">
                  <legend> Create Pandit </legend>
                </div>
                <div class="form-group">
                  <label class="col-sm-2 control-label">Select Pandit:</label>
                  <div class="col-sm-6">
                    <label class="radio-inline"> <input type="radio" ng-model="radioAppointment.selected_pandit_type" ng-init="radioAppointment.selected_pandit_type = 2" ng-value=2 ng-change="changePanditType()"> New </label>
                    <label class="radio-inline"> <input type="radio" ng-model="radioAppointment.selected_pandit_type" ng-value=1 ng-change="changePanditType()"> Existing </label>
                  </div>
                </div>
                <div ng-show="showNewPandit">
                  <div class="form-group">
                    <div class="col-sm-offset-2 col-sm-1">
                      <button type="button" class="btn btn-default btn-success" aria-label="Left Align" ng-click="addPandit()">
                        <span class="glyphicon glyphicon-plus" aria-hidden="true"></span> Add Pandit
                      </button>
                    </div>
                  </div>
                  <div ng-repeat="subitem in selectPanditDetails.subitems track by $index">
                    <sub-pandit-item-partial></sub-item-partial>
                  </div>
                </div>
                <div ng-hide="showNewPandit">
                  <div class="form-group">
                    <div class="col-sm-6 col-sm-offset-2">
                      <ui-select multiple ng-model="multipleItmes.selectedPeople" ng-disabled="disabled">
                        <ui-select-match placeholder="Select pandit...">{{$item.first_name}} {{$item.last_name}}</ui-select-match>
                        <ui-select-choices repeat="person in panditList | propsFilter: {first_name: $select.search, last_name: $select.search}">
                          <div ng-bind-html="person.first_name + ' ' + person.last_name| highlight: $select.search"></div>
                          <small>
                            email: {{person.email}}
                            phone: <span ng-bind-html="''+person.phone_number | highlight: $select.search"></span>
                          </small>
                        </ui-select-choices>
                      </ui-select>
                    </div>
                  </div>
                </div>
              </div>
              <div class="form-group">
                <div class="col-sm-offset-2 col-sm-3">
                  <button type="submit" class="btn btn-default" ng-click="createKaryalayDependency()">Sumbit All Details</button>
                </div>
              </div>
            </form>
          </fieldset>
        </accordion-group>
      </accordion>
    </div>
  </div>
</div>
